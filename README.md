# Simple face bounding model (простая модель для обводки лиц)

Простая учебная реализация собственной модели для предсказания ограничивающего прямоугольника лица (bbox).

Файлы:
- `model.py` — класс `SimpleFaceDetector` (пошагово, без предобученных архитектур).
- `train.py` — простой скрипт тренировки с синтетическим датасетом (демонстрация цикла обучения).
- `requirements.txt` — минимальные зависимости.

Как запустить (локально):
1. Установите зависимости (предпочтительно в виртуальном окружении):

```powershell
pip install -r requirements.txt
```

2. Запустите тренировку (скрипт использует синтетические данные, чтобы показать работу):

```powershell
python train.py
```

После завершения в папке появится `simple_face_detector.pth`.

Дальше: используйте реальный датасет (например CSV с аннотациями или COCO/CSV), добавьте аугментации, метрики (IoU) и визуализацию предсказанных боксов на изображении.

Поддержка формата YOLO Darknet
--------------------------------
Скрипт `train.py` теперь умеет автоматически загружать датасет в формате YOLO Darknet, если вы положите папку `data/` рядом с кодом.

Ожидаемая структура (пример):

data/
	images/
		0001.jpg
		0002.jpg
	labels/
		0001.txt
		0002.txt

Каждый файл `.txt` должен содержать строки формата:

```
<class_id> <cx> <cy> <w> <h>
```

где `cx,cy,w,h` — нормализованные значения в диапазоне [0,1] (как в Darknet / YOLO). Если в файле несколько строк (несколько объектов), скрипт выбирает bbox с наибольшей площадью (w*h).

Если папки `data/` нет или в ней не найдены изображения, скрипт будет использовать синтетические данные, как и раньше.

Запуск с реальным датасетом (пример):

```powershell
# разместите ваш датасет в папке c:\Users\Maxim\Desktop\face_detection\data
python train.py
```

Потом можно добавить визуализацию предсказаний, валидацию и сохранение чекпоинтов.

Тестовый скрипт инференса
-------------------------
Добавлен `test.py` — он загружает модель (по умолчанию `best_simple_face_detector.pth`), прогоняет все изображения из `data/images/` (или `data/`) и сохраняет версии изображений с прорисованными предсказанными bbox в папке `out/`.

Пример запуска:

```powershell
python test.py --model best_simple_face_detector.pth --data data --out out --device cpu
```

Конвертация форматов
--------------------
Модель по умолчанию возвращает bbox в виде нормализованных (cx,cy,w,h). Скрипты автоматически конвертируют это в нормализованный (x1,y1,x2,y2) и далее в пиксели для прорисовки.
