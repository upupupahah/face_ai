# Simple face bounding model (простая модель для обводки лиц)

Простая учебная реализация собственной модели для предсказания ограничивающего прямоугольника лица (bbox).

Файлы:
- `model.py` — класс `SimpleFaceDetector` (пошагово, без предобученных архитектур).
- `train.py` — простой скрипт тренировки с синтетическим датасетом (демонстрация цикла обучения).
- `requirements.txt` — минимальные зависимости.

Как запустить (локально):
1. Установите зависимости (предпочтительно в виртуальном окружении):

```powershell
pip install -r requirements.txt
```

2. Запустите обучение (скрипт использует синтетические данные, чтобы показать работу):

```powershell
python train.py
```

После завершения в папке появится `best_model.pth`.

Скрипт `train.py` загружает датасет в формате YOLO Darknet, если вы поместите папку `data/` в рабочую директорию.

Ожидаемая структура (пример):
```
data/
	images/
		0001.jpg
		0002.jpg
		...
	labels/
		0001.txt
		0002.txt
		...
```

Каждый файл `.txt` должен содержать строки формата:

```
<class_id> <cx> <cy> <w> <h>
```

где `cx,cy,w,h` — нормализованные значения в диапазоне [0,1] (в формате YOLO Darknet). Если в файле несколько строк (несколько объектов), скрипт выбирает bbox с наибольшей площадью (w*h).

--------------------
 `test.py` — скрипт для тестирования обученной модели, загружает модель (по умолчанию `best_model.pth`), прогоняет все изображения из `data/images/` (или `data/`) и сохраняет версии изображений с прорисованными предсказанными bbox в папке `out/`.


Конвертация форматов
--------------------
Модель по умолчанию возвращает bbox в виде нормализованных (cx,cy,w,h). Скрипты автоматически конвертируют это в нормализованный (x1,y1,x2,y2) и далее в пиксели для прорисовки.

--------------------
тестовая выборка лежит в архиве `out.zip`.